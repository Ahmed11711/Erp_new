<div class="container-fluid">
  <div class="row py-3">
    <div class="col-4 d-flex align-items-center">
      <app-time></app-time>
    </div>
    <div class="col-5">
      <div><p class="title header w-50 m-auto"> Add Lead سسسس</p></div>
    </div>
    <div class="col-3 d-flex align-items-center justify-content-end">
      <!-- <app-time></app-time> -->
    </div>
  </div>

  <div dir="ltr" class="container-fluid">
    <form class="text-start w-100 mt-2" [formGroup]="form" (ngSubmit)="submitform()">

      <div class="row mb-3">
        <div class="col-md-2">

          <ng-autocomplete
            [data]="leadIndustry"
            [searchKeyword]="industry"
            placeholder="Industry"
            (keyup)="industryKeyUp($event)"
            (selected)='industryChange($event)'
            (inputCleared)="resetIndustry()"
            [itemTemplate]="itemTemplates1"
            [notFoundTemplate]="notFoundTemplate1">
          </ng-autocomplete>

          <ng-template #itemTemplates1 let-item>
            <a [innerHTML]="item.name"></a>
          </ng-template>

          <ng-template #notFoundTemplate1 let-notFound>
            <div [innerHTML]="notFound"></div>
          </ng-template>
        </div>

        <div class="col-md-2">

          <ng-autocomplete
            [data]="countries"
            [searchKeyword]="catword"
            placeholder="choose country"
            (selected)='countryChange($event)'
            (inputCleared)="resetInp()"
            [itemTemplate]="itemTemplates"
            [notFoundTemplate]="notFoundTemplate">
          </ng-autocomplete>

          <ng-template #itemTemplates let-item>
            <a [innerHTML]="item.name"></a>
          </ng-template>

          <ng-template #notFoundTemplate let-notFound>
            <div [innerHTML]="notFound"></div>
          </ng-template>
        </div>

        <div class="col-md-2">
          <input
          [class.is-valid]="form.get('date')?.errors ==null && form.get('date')?.touched"
          [class.is-invalid]="form.get('date')?.errors !=null && form.get('date')?.touched"
          autocomplete="off" formControlName="date" class="form-control" type="date">
        </div>
      </div>

      <div class="row">
        <div class="col-md-3">
          <div class="mb-3">
            <input autocomplete="off" class="form-control" placeholder="Company Name"
            [class.is-valid]="form.get('company_name')?.errors ==null && form.get('company_name')?.touched"
            [class.is-invalid]="form.get('company_name')?.errors !=null && form.get('company_name')?.touched"
            formControlName='company_name' type="text" class="form-control">
          </div>
        </div>


        <!-- contact data -->
        <div class="col-md-5" dir="ltr" formArrayName="contacts">
          <div class="row mb-2" style="border-bottom: solid 1px #82225e;" *ngFor="let contactGroup of contacts.controls; let i = index" [formGroupName]="i">
            <div class="col-md-5">
              <div class="mb-3">
                <div class="d-flex align-items-center mb-3">
                  <input autocomplete="off" class="form-control" placeholder="Contact Name"
                  [class.is-valid]="contactGroup.get('contact_name')?.errors ==null && contactGroup.get('contact_name')?.touched"
                  [class.is-invalid]="contactGroup.get('contact_name')?.errors !=null && contactGroup.get('contact_name')?.touched"
                  formControlName='contact_name' type="text" class="form-control">
                  <i class="fa-solid fa-trash mr-2" style="cursor: pointer;" *ngIf="i > 0" (click)="removeContact(i)"></i>
                </div>
                <div class="d-flex align-items-center">
                  <input autocomplete="off" class="form-control" placeholder="Contact LinkedIn"
                  [class.is-valid]="contactGroup.get('contact_linkedin')?.errors ==null && contactGroup.get('contact_linkedin')?.touched"
                  [class.is-invalid]="contactGroup.get('contact_linkedin')?.errors !=null && contactGroup.get('contact_linkedin')?.touched"
                  formControlName='contact_linkedin' type="text" class="form-control">
                </div>
              </div>
            </div>
            <div class="col-md-7">

              <div formArrayName="phones">
                <div class="mb-3 d-flex align-items-center" *ngFor="let phoneGroup of getPhones(i).controls; let j = index" [formGroupName]="j">
                  <div style="margin-inline-end: 5px; width: 140px;">
                    <select class="form-control form-select" formControlName="dial_code">
                      <option [value]="elm.dial_code" *ngFor="let elm of countries">{{elm.dial_code}}</option>
                    </select>
                  </div>
                  <div class="w-100">
                    <input autocomplete="off" class="form-control" placeholder="Contact number"
                    [class.is-valid]="phoneGroup.get('contact_number')?.errors ==null && phoneGroup.get('contact_number')?.touched"
                    [class.is-invalid]="phoneGroup.get('contact_number')?.errors !=null && phoneGroup.get('contact_number')?.touched"
                    formControlName='contact_number' type="text" class="form-control">
                  </div>
                  <div>
                    <i class="fa-solid fa-trash mr-2" style="cursor: pointer;" *ngIf="j > 0" (click)="removePhone(i,j)"></i>
                  </div>
                </div>
                <i class="fa-solid fa-plus mr-2" style="cursor: pointer; color: #82225e;" (click)="addPhone(i)"></i>
              </div>

              <div formArrayName="emails">
                <div class="mb-3 d-flex align-items-center" *ngFor="let emailCtrl of getEmails(i).controls; let j = index">
                  <div class=" w-100">
                    <input autocomplete="off" class="form-control" placeholder="Contact Email"
                      [class.is-valid]="emailCtrl.valid && emailCtrl.touched"
                      [class.is-invalid]="emailCtrl.invalid && emailCtrl.touched"
                      [formControlName]='j' type="text" class="form-control">
                  </div>
                  <div>
                    <i class="fa-solid fa-trash mr-2" style="cursor: pointer;" *ngIf="j > 0" (click)="removeEmail(i,j)"></i>
                  </div>
                </div>
                <i class="fa-solid fa-plus mr-2" style="cursor: pointer; color: #82225e;" (click)="addEmail(i)"></i>
              </div>
            </div>
          </div>
          <div class="text-right">
            <button type="button" class="btn btn-info mb-2" style="background-color: #82225e;" (click)="addContact()">
              <i class="fa-solid fa-plus mr-2" style="cursor: pointer; color: white;" ></i>
              Add Contact
            </button>
          </div>

        </div>
        <!--end contact data -->



        <div class="col-md-3">
          <div class="mb-3 d-flex align-items-center">
            <select class="form-control"
              [class.is-valid]="form.get('lead_source')?.errors ==null && form.get('lead_source')?.touched"
              [class.is-invalid]="form.get('lead_source')?.errors !=null && form.get('lead_source')?.touched"
              formControlName='lead_source'>
              <option value="0" disabled selected>Select Source</option>
              <option [value]="elm?.id" *ngFor="let elm of leadSource">{{elm?.name}}</option>
            </select>
            <i class="fa-solid fa-plus mr-2" style="cursor: pointer; color: #82225e;" (click)="addSource()"></i>

          </div>
          <div class="mb-3 d-flex align-items-center">
            <select class="form-control"
              [class.is-valid]="form.get('lead_tool')?.errors ==null && form.get('lead_tool')?.touched"
              [class.is-invalid]="form.get('lead_tool')?.errors !=null && form.get('lead_tool')?.touched"
              formControlName='lead_tool'>
              <option value="0" disabled selected>Select Tool</option>
              <option [value]="elm?.id" *ngFor="let elm of leadTools">{{elm?.name}}</option>
            </select>
            <i class="fa-solid fa-plus mr-2" style="cursor: pointer; color: #82225e;" (click)="addTool()"></i>

          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-3">
          <div class="mb-3">
            <input autocomplete="off" class="form-control" placeholder="LinkedIn Link"
            [class.is-valid]="form.get('company_linkedin')?.errors ==null && form.get('company_linkedin')?.touched"
            [class.is-invalid]="form.get('company_linkedin')?.errors !=null && form.get('company_linkedin')?.touched"
            formControlName='company_linkedin' type="text" class="form-control">
          </div>
        </div>
        <div class="col-md-3">
          <div class="mb-3">
            <input autocomplete="off" class="form-control" placeholder="Instagram Link"
            [class.is-valid]="form.get('company_instagram')?.errors ==null && form.get('company_instagram')?.touched"
            [class.is-invalid]="form.get('company_instagram')?.errors !=null && form.get('company_instagram')?.touched"
            formControlName='company_instagram' type="text" class="form-control">
          </div>
        </div>
        <div class="col-md-3">
          <div class="mb-3">
            <input autocomplete="off" class="form-control" placeholder="Facebook Link"
            [class.is-valid]="form.get('company_facebook')?.errors ==null && form.get('company_facebook')?.touched"
            [class.is-invalid]="form.get('company_facebook')?.errors !=null && form.get('company_facebook')?.touched"
            formControlName='company_facebook' type="text" class="form-control">
          </div>
        </div>
        <div class="col-md-3">
          <div class="mb-3">
            <input autocomplete="off" class="form-control" placeholder="Website Link"
            [class.is-valid]="form.get('company_website')?.errors ==null && form.get('company_website')?.touched"
            [class.is-invalid]="form.get('company_website')?.errors !=null && form.get('company_website')?.touched"
            formControlName='company_website' type="text" class="form-control">
          </div>
        </div>
        <div class="col-md-12">
          <textarea class="form-control" placeholder="Notes" name="" id="" cols="20" formControlName='notes'
            [class.is-valid]="form.get('notes')?.errors ==null && form.get('notes')?.touched"
            [class.is-invalid]="form.get('notes')?.errors !=null && form.get('notes')?.touched"
            ></textarea>
        </div>


      </div>



      <!-- <div class="row text-center mt-3">
        <div class="col-md-2">
          <div class="form-group">
            <div class="element">
                <i (click)="openFileInput()" class="fa fa-camera"></i><span class="name"> {{imgtext}} </span>
                <input autocomplete="off" type="file" (change)="onFileChanged($event)" name="uploadFile"
                accept="image/*" id="fileInput"  class="img" formControlName='expense_image'>
              </div>
          </div>
        </div>
      </div> -->


      <div class="text-center mt-2">
        <button
          type="submit" class="btn submit text-white">Add</button>
      </div>

    </form>
  </div>







</div>

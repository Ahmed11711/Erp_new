<div dir="rtl" class="d-flex justify-content-between">
  <h1 mat-dialog-title>إرسال رسالة واتساب</h1>
</div>
<div mat-dialog-content>
  <form dir="rtl" class="text-first w-100 mt-2" [formGroup]="form" (ngSubmit)="submitform()">
    
    <div class="form-group" *ngIf="templates.length > 0">
      <label>استخدام قالب</label>
      <select class="form-control" formControlName="template_id" (change)="useTemplate($any($event.target).value)">
        <option [value]="null">اختر قالب (اختياري)</option>
        <option *ngFor="let template of templates" [value]="template.id">{{template.name}}</option>
      </select>
    </div>

    <div class="form-group">
      <label>الرسالة</label>
      <textarea 
        class="form-control" 
        rows="5"
        placeholder="اكتب الرسالة هنا..."
        [class.is-valid]="form.get('message')?.errors == null && form.get('message')?.touched"
        formControlName="message"
      ></textarea>
      <p *ngIf="form.get('message')?.errors != null && form.get('message')?.touched"
        class="error mb-0 text-danger">مطلوب</p>
    </div>

    <div class="d-flex justify-content-center">
      <button 
        class="btn btn-success" 
        [disabled]="form.invalid || loading"
        type="submit"
      >
        <span *ngIf="loading">جاري الإرسال...</span>
        <span *ngIf="!loading">إرسال</span>
      </button>
      <a mat-button (click)="onCloseClick()" class="btn btn-danger mx-2">إلغاء</a>
    </div>
  </form>
</div>
